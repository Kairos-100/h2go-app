<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H2GO - Supplementation Intelligence for Amateur Runners</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="AI-powered supplement recommendations for amateur runners. Get personalized supplement plans based on your running profile.">
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="H2GO">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Icons for PWA -->
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/icons/icon-512x512.png">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Scripts -->
    <script src="translations.js"></script>
</head>
<body>
    <!-- Registration Modal -->
    <div id="registrationModal" class="registration-modal">
        <div class="registration-content">
            <div class="registration-header">
                <h2 data-i18n="reg_welcome">Welcome to H2GO</h2>
                <p data-i18n="reg_trial">Start your free trial</p>
            </div>
            <form id="registrationForm" class="registration-form">
                <div class="form-group">
                    <label for="userName" data-i18n="reg_name">Full name</label>
                    <input type="text" id="userName" name="userName" data-i18n="reg_name_placeholder" placeholder="Your name" required>
                </div>
                <div class="form-group">
                    <label for="userEmail" data-i18n="reg_email">Email</label>
                    <input type="email" id="userEmail" name="userEmail" data-i18n="reg_email_placeholder" placeholder="your@email.com" required>
                </div>
                <div class="terms-checkbox">
                    <input type="checkbox" id="acceptTerms" required>
                    <label for="acceptTerms" data-i18n="reg_terms">I accept the terms and conditions of use</label>
                </div>
                <button type="submit" class="btn-primary btn-register" data-i18n="reg_btn_start">Start free trial</button>
                <p class="trial-info" data-i18n="reg_no_card">✨ No credit card required</p>
            </form>
        </div>
    </div>

    <!-- API Status Indicator -->
    <div id="apiStatus" class="api-status hidden">
        <span id="apiStatusText" data-i18n="api_checking">Checking connection...</span>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="assets/logos/H2GO AQUA.png" alt="H2G Logo" class="nav-logo-img">
            </div>
            <div class="nav-menu">
                <a href="#home" class="nav-link" data-i18n="nav_home">Home</a>
                <a href="#how-it-works" class="nav-link" data-i18n="nav_how_it_works">How It Works</a>
                <a href="#questionnaire" class="nav-link" data-i18n="nav_get_started">Get Started</a>
                <a href="#contact" class="nav-link" data-i18n="nav_contact">Contact</a>
            </div>
            <div class="nav-toggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <!-- Background Video -->
        <div class="video-background">
            <video id="heroVideo" autoplay muted loop playsinline preload="metadata" 
                   poster="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 800'%3E%3Crect width='100%25' height='100%25' fill='%232563eb'/%3E%3C/svg%3E">
                <source src="assets/videos/hero-video.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div class="video-overlay"></div>
            <!-- Fallback background image -->
            <div class="video-fallback" style="background: linear-gradient(135deg, rgba(37, 99, 235, 0.8) 0%, rgba(59, 130, 246, 0.6) 50%, rgba(147, 197, 253, 0.4) 100%); background-size: cover; background-position: center; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -2;"></div>
        </div>
        <div class="hero-container">
            <div class="hero-content">
                <h1 class="hero-title" data-i18n="hero_title">Supplementation Intelligence for Amateur Runners</h1>
                <p class="hero-description" data-i18n="hero_description">
                    Get personalized supplement recommendations based on your running profile. 
                    Our AI analyzes your height, weight, running distance, and goals to provide 
                    the perfect supplementation strategy.
                </p>
                <div class="hero-buttons">
                    <button class="btn-primary" onclick="scrollToQuestionnaire()" data-i18n="hero_btn_start">Start Your Journey</button>
                    <button class="btn-secondary" onclick="scrollToHowItWorks()" data-i18n="hero_btn_learn">Learn More</button>
                </div>
            </div>
            <div class="hero-image">
                <div class="runner-illustration">
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works Section -->
    <section id="how-it-works" class="how-it-works">
        <div class="container">
            <h2 class="section-title" data-i18n="how_title">How H2GO Works</h2>
            <div class="steps-grid">
                <div class="step">
                    <div class="step-icon">
                        <i class="fas fa-user"></i>
                    </div>
                    <h3 data-i18n="how_step1_title">1. Tell Us About Yourself</h3>
                    <p data-i18n="how_step1_desc">Share your height, weight, running experience, and fitness goals through our interactive chat.</p>
                </div>
                <div class="step">
                    <div class="step-icon">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h3 data-i18n="how_step2_title">2. AI Analysis</h3>
                    <p data-i18n="how_step2_desc">Our intelligent system analyzes your data to understand your specific nutritional needs.</p>
                </div>
                <div class="step">
                    <div class="step-icon">
                        <i class="fas fa-pills"></i>
                    </div>
                    <h3 data-i18n="how_step3_title">3. Get Recommendations</h3>
                    <p data-i18n="how_step3_desc">Receive personalized supplement recommendations with timing, dosage, and rationale.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Questionnaire Section -->
    <section id="questionnaire" class="questionnaire">
        <div class="container">
            <h2 class="section-title" data-i18n="quest_title">Get Your Personalized Supplement Plan</h2>
            <div class="questionnaire-container">
                <div class="phone-frame">
                    <div class="chat-container">
                        <div class="chat-header">
                            <h3 data-i18n="quest_assistant">H2GO Assistant</h3>
                            <div class="chat-status">
                                <span class="status-dot"></span>
                                <span data-i18n="quest_online">Online</span>
                            </div>
                        </div>
                        <div class="chat-messages" id="chatMessages">
                            <div class="message bot-message">
                                <div class="message-content">
                                    <p data-i18n="chat_greeting">Hi! I'm your H2GO assistant. I'll help you create a personalized supplement plan for your running journey. Let's start with some basic information about you.</p>
                                </div>
                            </div>
                        </div>
                        <div class="chat-input-container">
                            <input type="text" id="chatInput" data-i18n="quest_placeholder" placeholder="Type your answer here..." disabled>
                            <button id="sendButton" disabled>
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="form-container" style="display: none;">
                    <!-- Formulario movido al chat -->
                    <div style="text-align: center; padding: 2rem; color: #64748b;">
                        <i class="fas fa-info-circle" style="font-size: 3rem; margin-bottom: 1rem; color: #2563eb;"></i>
                        <h3>Formulario integrado en el chat</h3>
                        <p>Ahora puedes completar tu perfil directamente en la conversación con el asistente.</p>
                        <p style="margin-top: 1rem; font-size: 0.9rem;">
                            <i class="fas fa-arrow-up"></i> 
                            Usa el chat de arriba para obtener tu plan personalizado
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Results Section (Hidden - results now appear in chat) -->
    <section id="results" class="results" style="display: none;">
        <div class="container">
            <h2 class="section-title">Your Personalized Supplement Plan</h2>
            <div class="results-container" id="resultsContainer">
                <!-- Results will be populated by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact">
        <div class="container">
            <h2 class="section-title" data-i18n="contact_title">Get in Touch</h2>
            <div class="contact-content">
                <div class="contact-info">
                    <h3 data-i18n="contact_subtitle">Have Questions?</h3>
                    <p data-i18n="contact_desc">Our team of nutrition experts is here to help you optimize your running performance through proper supplementation.</p>
                    <div class="contact-details">
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <a href="mailto:info@kairoscompany.es" data-i18n="contact_email">info@kairoscompany.es</a>
                        </div>
                    </div>
                </div>
                <div class="contact-form">
                    <form>
                        <div class="form-group">
                            <input type="text" data-i18n="contact_name_placeholder" placeholder="Your Name" required>
                        </div>
                        <div class="form-group">
                            <input type="email" data-i18n="contact_email_placeholder" placeholder="Your Email" required>
                        </div>
                        <div class="form-group">
                            <textarea data-i18n="contact_message_placeholder" placeholder="Your Message" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="btn-primary" data-i18n="contact_btn_send">Send Message</button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="assets/logos/H2GO AQUA.png" alt="H2G Logo" class="footer-logo-img">
                </div>
                <div class="footer-links">
                    <div class="footer-column">
                        <h4 data-i18n="footer_product">Product</h4>
                        <a href="#how-it-works" data-i18n="nav_how_it_works">How It Works</a>
                        <a href="#questionnaire" data-i18n="nav_get_started">Get Started</a>
                    </div>
                    <div class="footer-column">
                        <h4 data-i18n="footer_support">Support</h4>
                        <a href="#contact" data-i18n="nav_contact">Contact</a>
                        <a href="#" data-i18n="footer_faq">FAQ</a>
                    </div>
                    <div class="footer-column">
                        <h4 data-i18n="footer_legal">Legal</h4>
                        <a href="#" data-i18n="footer_privacy">Privacy Policy</a>
                        <a href="#" data-i18n="footer_terms">Terms of Service</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p data-i18n="footer_copyright">&copy; 2024 H2GO. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // Initialize language manager after all scripts are loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.languageManager = new LanguageManager();
        });

        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('✅ Service Worker registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    if (confirm('Nueva versión disponible. ¿Recargar para actualizar?')) {
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.error('❌ Service Worker registration failed:', error);
                    });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            
            // Show install button/banner (optional - you can implement this UI)
            showInstallPromotion();
        });

        function showInstallPromotion() {
            // Optional: Create a banner/button to prompt installation
            const installBanner = document.createElement('div');
            installBanner.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #2563eb;
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                z-index: 10000;
                display: flex;
                align-items: center;
                gap: 15px;
                font-family: Inter, sans-serif;
            `;
            installBanner.innerHTML = `
                <span>📱 Instala H2GO como app</span>
                <button onclick="installPWA()" style="background: white; color: #2563eb; border: none; padding: 8px 16px; border-radius: 6px; font-weight: 600; cursor: pointer;">Instalar</button>
                <button onclick="this.parentElement.remove()" style="background: transparent; color: white; border: 1px solid white; padding: 8px 16px; border-radius: 6px; cursor: pointer;">Cerrar</button>
            `;
            document.body.appendChild(installBanner);
            
            // Auto-hide after 10 seconds
            setTimeout(() => {
                if (installBanner.parentElement) {
                    installBanner.remove();
                }
            }, 10000);
        }

        window.installPWA = async function() {
            if (!deferredPrompt) return;
            
            // Show the install prompt
            deferredPrompt.prompt();
            
            // Wait for the user to respond to the prompt
            const { outcome } = await deferredPrompt.userChoice;
            console.log(`User response to the install prompt: ${outcome}`);
            
            // Clear the deferredPrompt
            deferredPrompt = null;
            
            // Remove the install banner
            const banner = document.querySelector('div[style*="fixed"]');
            if (banner) banner.remove();
        };

        // Track when app is installed
        window.addEventListener('appinstalled', () => {
            console.log('✅ H2GO PWA installed successfully!');
            deferredPrompt = null;
        });
    </script>
</body>
</html>
